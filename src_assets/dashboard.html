<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Панель состояния</title>
<style>:root{--primary:#3c50e0;--bg-body:#f1f5f9;--bg-card:#ffffff;--text-main:#1c2434;--border:#e2e8f0}*{box-sizing:border-box;margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif}body{background:var(--bg-body);color:var(--text-main);font-size:14px;line-height:1.5;padding:20px}.card{background:var(--bg-card);border-radius:4px;box-shadow:0 1px 3px rgba(0,0,0,.1);margin-bottom:20px;border:1px solid var(--border)}.card-header{padding:15px 20px;border-bottom:1px solid var(--border);font-weight:600;font-size:16px}.card-body{padding:0}.row{display:flex;gap:20px;flex-wrap:wrap}.col{flex:1;min-width:300px}table{width:100%;border-collapse:collapse}th,td{padding:12px 15px;text-align:left;border-bottom:1px solid var(--border)}th{font-weight:600;background:#f7f9fc}tr:hover{background:#f7f9fc}.h2{font-size:24px;font-weight:700;margin-bottom:20px;color:var(--text-main)}</style>
</head>
<body>
<h1 class="h2">Панель состояния</h1>
<div class="row">
<div class="col">
<div class="card">
<div class="card-header">Информация о ПО</div>
<div class="card-body">
<table>
<tbody>
<tr><td>Целевое устройство</td><td id="fwinfo_device">...</td></tr>
<tr><td>Версия ПО</td><td id="fwinfo_version">...</td></tr>
<tr><td>Время сборки</td><td id="fwinfo_timestamp">...</td></tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="col">
<div class="card">
<div class="card-header">Состояние устройства</div>
<div class="card-body">
<table>
<tbody>
<tr><td>Время работы</td><td id="tlm_uptime">...</td></tr>
<tr><td>Внешнее тактирование</td><td id="tlm_hse">...</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="row">
<div class="col">
<div class="card">
<div class="card-header">АЦП</div>
<div class="card-body">
<table>
<tbody>
<tr><td>Температура МК</td><td id="adc_temp">...</td></tr>
<tr><td>Напряжение МК</td><td id="adc_vdda">...</td></tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="col">
<div class="card">
<div class="card-header">Сеть</div>
<div class="card-body">
<table>
<tbody>
<tr><td>Соединение</td><td id="net_link_up">...</td></tr>
<tr><td>Перегрузка</td><td id="net_oc">...</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<script>
function pollFunc(fn, interval) {
(function p() {
if (fn()) { setTimeout(p, interval); }
})();
}
function loadJSON(path, success, error) {
var xhr = new XMLHttpRequest();
xhr.timeout = 900;
xhr.onreadystatechange = function () {
if (xhr.readyState === XMLHttpRequest.DONE) {
if (xhr.status === 200) { if (success) success(JSON.parse(xhr.responseText)); }
else { if (error) error(xhr); }
}
};
xhr.open("GET", path, true);
xhr.send();
}
function onContent(data) {
for (var key in data) {
var el = document.getElementById(key);
if (el != null) {
el.innerText = data[key];
if (el.innerText == '4294967.5' || el.innerText == "4294967295") {
el.innerText = "ТАЙМАУТ"
}
}
}
}
function updateData(params) {
loadJSON('/status.json', onContent, null)
return true;
}
pollFunc(updateData, 1000);
</script>
</body>
</html>